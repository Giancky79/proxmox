<VirtualHost *:80>
    ServerName #nome-dominio
    Redirect / https://#nome-dominio/
</VirtualHost>

<IfModule mod_ssl.c>
    SSLStaplingCache        shmcb:/var/run/ocsp(128000)
    <VirtualHost *:443>
        ServerName #nome-dominio
        Header always set Strict-Transport-Security "max-age=15552000; includeSubDomains; preload"
        SSLEngine on
        SSLProxyEngine on
        SSLProxyVerify none
        SSLProxyCheckPeerCN off
        SSLProxyCheckPeerName off
        SSLCipherSUite "EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384 EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH EDH+aRSA !CAMELLIA !SEED !3DES !RC4 !aNULL !eNULL !LOW !MD5 !EXP !PSK !SRP !DSS"
        SSLProtocol -all +TLSv1.2 +TLSv1.3
        SSLCompression off
        SSLUseStapling          on
        SSLStaplingResponderTimeout 5
        SSLStaplingReturnResponderErrors off
        ProxyRequests off
        ProxyPreserveHost on
        <Location />
            ProxyPass https://192.168.x.x:8006/
            ProxyPassReverse https://192.168.x.x:8006/
        </Location>
        <LocationMatch ^/(api2/json/nodes/[^\/]+/[^\/]+/[^\/]+/vncwebsocket.*)$>
            ProxyPass wss://192.168.x.x:8006/$1 retry=0
        </LocationMatch>
        <Location /websockify>
            ProxyPass ws://192.168.x.x:8006
            ProxyPassReverse ws://192.168.x.x:8006
        </Location>
        <LocationMatch ^/(api2/json/nodes/[^\/]+/vncwebsocket.*)$>
            ProxyPass wss://192.168.x.x:8006/$1 retry=0
        </LocationMatch>
    </VirtualHost>
</IfModule>
