<VirtualHost *:80>
    ServerName 
    Redirect / https://nome_scelto.dominio.it/
</VirtualHost>

<VirtualHost *:443>
  ServerName nome_scelto.dominio.it
  ProxyPreserveHost On
  ProxyRequests off
  ProxyPass /api/websocket ws://192.168.x.x:8123/api/websocket
  ProxyPassReverse /api/websocket ws://192.168.x.x:8123/api/w$
  ProxyPass / http://192.168.x.x:8123/
  ProxyPassReverse / http://192.168.x.x:8123/
  RewriteEngine on
  RewriteCond %{HTTP:Upgrade} =websocket [NC]
  RewriteRule /(.*)  ws://192.168.x.x:8123/$1 [P,L]
  RewriteCond %{HTTP:Upgrade} !=websocket [NC]
  RewriteRule /(.*)  http://192.168.x.x:8123/$1 [P,L]
</VirtualHost>
